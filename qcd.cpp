
#include <math.h>
#include <cmath>
#include <stdlib.h>
using namespace std;
#include <iostream>
#include "qcd.hpp"



// lattice qcd quantities: expressions are rational polynomial fits to lattice data


double equilibriumPressure(double e) // Peq in units of fm^-4
{
	#ifndef CONFORMAL_EOS

	    // Equation of state of BEST collaboration
		#ifdef BEST
		    double e2 = e*e;
		    double e3 = e2*e;
		    double e4 = e3*e;
		    double e5 = e4*e;
		    double e6 = e5*e;
		    double e7 = e6*e;
		    double e8 = e7*e;
		    double e9 = e8*e;
		    double e10 = e9*e;
		    double e11 = e10*e;
		    double e12 = e11*e;
		    double e13 = e12*e;
		    double e14 = e13*e;
		    double e15 = e14*e;
		    double e16 = e15*e;
		    double e17 = e16*e;
		    double e18 = e17*e;
		    double e19 = e18*e;
		    double e20 = e19*e;
		    double e21 = e20*e;
		    double e22 = e21*e;
		    double e23 = e22*e;
		    double e24 = e23*e;



		    // super accurate

		    return (7.190009839568977e-11 - 1.395774723345131e-6*e - 0.0007294542973192687*e2 - 0.02755303080259852*e3 +
     0.6777139269471448*e4 - 2.5676157307802105*e5 - 198.27861304635795*e6 + 2892.771435243516*e7 -
     20443.08028356625*e8 + 26431.269835104275*e9 + 54554.71732475857*e10 - 136384.84011985105*e11 +
     170729.28261000666*e12 - 109354.23042660154*e13 + 47809.54395258853*e14 - 10743.012809422258*e15 +
     1573.4464820882827*e16 + 73.09843404933184*e17 + 33.75839022332086*e18 + 22.370532570822895*e19 +
     0.8661540343959165*e20 + 0.00823546974656238*e21 + 0.000011977402417543487*e22 -
     3.823554294234436e-8*e23 - 4.015185097090365e-11*e24)/
   (-7.4539090540790035e-6 - 0.003091276650747094*e - 0.10715341272046117*e2 + 2.2410756562049117*e3 +
     3.147397633194132*e4 - 977.4165681862902*e5 + 12218.017097992242*e6 - 74668.39069402599*e7 -
     8194.662719386062*e8 + 604927.8696703409*e9 - 1.1027507974839194e6*e10 + 1.2140822058208985e6*e11 -
     738923.1898118919*e12 + 316237.5914113029*e13 - 71392.6962417791*e14 + 11335.190090043036*e15 -
     109.3640028588883*e16 + 449.6151741523075*e17 + 106.96820874330709*e18 + 3.348031043873812*e19 +
     0.027585414077599367*e20 + 0.0000337469979928549*e21 - 1.252632993005512e-7*e22 -
     1.2345479534532178e-10*e23 + 1.2680975061416364e-16*e24);

			// return (-8.084819479175374e-6 + 0.06291064273310303*e + 7.747293744841747*e2 + 25.77384998514719*e3 - 2226.899602434081*e4 + 35281.03627536701*e5 -
   //   64223.13723673896*e6 + 50283.620837098584*e7 - 74072.5650208399*e8 + 70981.88360905858*e9 - 34483.06185599816*e10 +
   //   13600.577220325598*e11 - 2639.7762753282555*e12 + 823.4182321803329*e13 + 38.10681304257428*e14 + 0.3351380530821829*e15 +
   //   0.0005040123570866494*e16)/
   // (0.29793379360925065 + 29.69609788600949*e + 235.79443559712217*e2 - 11059.748583415168*e3 + 153881.87248642274*e4 -
   //   172167.08799932175*e5 - 79612.42049871704*e6 + 21073.994949772194*e7 + 20020.630949670118*e8 + 15542.573088538831*e9 +
   //   9685.72041020551*e10 - 1652.4874392280246*e11 + 4164.09638467046*e12 + 146.653021125645*e13 + 1.112445891727518*e14 +
   //   0.0015579246120926726*e15 - 3.92779072386445e-9*e16);

	   	// Equation of state of Wuppertal-Budapest collaboration
	   	#else
	   		double e2 = e*e;
		    double e3 = e2*e;
		    double e4 = e3*e;
		    double e5 = e4*e;
		    double e6 = e5*e;
		    double e7 = e6*e;
		    double e8 = e7*e;
		    double e9 = e8*e;
		    double e10 = e9*e;
		    double e11 = e10*e;
		    double e12 = e11*e;
		    double e13 = e12*e;
		    double e14 = e13*e;
		    double e15 = e14*e;
		    double e16 = e15*e;
		    double e17 = e16*e;
		    double e18 = e17*e;
		    double e19 = e18*e;
		    double e20 = e19*e;
		    double e21 = e20*e;
		    double e22 = e21*e;


		    return (5.075564888183663e-8 - 0.0000562169058017086*e - 0.22264079778393814*e2 - 96.54111777097086*e3 -
     1756.4940900442318*e4 - 3839.550980182813*e5 + 43314.75256472724*e6 + 21484.684622349*e7 -
     130046.39756226703*e8 + 31055.12603591556*e9 + 39710.876799090234*e10 - 1699.2739439957898*e11 +
     457.07148223707463*e12 - 2.6124197272811243*e13 - 10.644483495536646*e14 + 0.9338976604508398*e15 -
     0.08154575247701629*e16 + 0.007945758495188623*e17 - 0.00032112712608626663*e18 +
     1.3849387546528496e-6*e19 + 1.0319807626964377e-7*e20 + 2.4411168029716984e-10*e21 -
     5.320369073003463e-14*e22)/
   (-0.00014387478025277176 - 1.1792584683886174*e - 389.6323718241302*e2 - 6977.840105310985*e3 -
     30423.03772874304*e4 + 172511.16609332536*e5 + 395148.28097748733*e6 - 927429.602347526*e7 -
     1969.7658108555734*e8 + 442307.7633162228*e9 - 61081.643776514844*e10 + 10031.861047012935*e11 -
     1004.1267102196177*e12 + 34.34877412677497*e13 - 1.1282071952740738*e14 - 0.03273759822023652*e15 +
     0.020818561379492638*e16 - 0.0011806678144587483*e17 + 9.452128098430316e-6*e18 +
     3.5138214637099674e-7*e19 + 7.566271511306246e-10*e20 - 1.7260152864418335e-13*e21 +
     2.3271917596080208e-18*e22);


	  //  		double a0 = -0.25181736420168666;
			// double a1 = 9737.845799644809;
			// double a2 = 1.077580993288114e6;
			// double a3 = 3.1729694865420084e6;
			// double a4 = 1.6357487344679043e6;
			// double a5 = 334334.4309240126;
			// double a6 = 41913.439282708554;
			// double a7 = 6340.448389300905;
			// double a8 = 141.5073484468774;
			// double a9 = 0.7158279081255019;
			// double a10 = 0.0009417586777847889;
			// double a11 = 3.1188455176941583e-7;
			// double a12 = 1.9531729608963267e-11;
			// double a = (double)fma(a12,e12,fma(a11,e11,fma(a10,e10,fma(a9,e9,fma(a8,e8,fma(a7,e7,fma(a6,e6,fma(a5,e5,fma(a4,e4,fma(a3,e3,fma(a2,e2,fma(a1,e,a0))))))))))));

			// double b0 = 45829.44617893836;
			// double b1 = 4.0574329080826794e6;
			// double b2 = 2.0931169138134286e7;
			// double b3 = 1.3512402226067686e7;
			// double b4 = 1.7851642641834426e6;
			// double b5 = 278581.2989342773;
			// double b6 = 26452.34905933697;
			// double b7 = 499.04919730607065;
			// double b8 = 2.3405487982094204;
			// double b9 = 0.002962497695527404;
			// double b10 = 9.601103399348206e-7;
			// double b11 = 5.928138360995685e-11;
			// double b12 = 3.2581066229887368e-18;
			// double b = (double)fma(b12,e12,fma(b11,e11,fma(b10,e10,fma(b9,e9,fma(b8,e8,fma(b7,e7,fma(b6,e6,fma(b5,e5,fma(b4,e4,fma(b3,e3,fma(b2,e2,fma(b1,e,b0))))))))))));
		    //return a / b;

		#endif
	#else
	    return e / 3.0;
	#endif
}


double speedOfSoundSquared(double e)
{
	#ifndef CONFORMAL_EOS

		// Speed of sound squared of BEST collaboration
		#ifdef BEST
			double e2 = e * e;
			double e3 = e2 * e;
			double e4 = e3 * e;
			double e5 = e4 * e;
			double e6 = e5 * e;
			double e7 = e6 * e;
			double e8 = e7 * e;
			double e9 = e8 * e;
			double e10 = e9 * e;
			double e11 = e10 * e;
			double e12 = e11 * e;
			double e13 = e12 * e;
			double e14 = e13 * e;
			double e15 = e14 * e;
		    double e16 = e15 * e;
		    double e17 = e16 * e;
		    double e18 = e17 * e;
		    double e19 = e18 * e;
		    double e20 = e19 * e;
		    double e21 = e20 * e;
		    double e22 = e21 * e;
		    double e23 = e22 * e;
		    double e24 = e23 * e;

		    // super accurate

			return (-8.313077825923736e-14 - 9.91131461236627e-11*e + 4.9370463998042573e-8*e2 + 0.000012403698595004402*e3 -
     0.0006912983927137311*e4 + 0.021581851285318674*e5 - 0.3403540349639598*e6 + 2.571364021486668*e7 +
     6.673093766060017*e8 - 243.3375964116734*e9 + 1814.6643869387997*e10 - 2548.2582086974326*e11 +
     2765.630246068556*e12 - 1875.00259667093*e13 + 1108.2896957487499*e14 - 404.3458694331876*e15 +
     102.97057964895681*e16 - 8.666160558180495*e17 + 1.7034256926427882*e18 + 0.1509835583259864*e19 +
     0.0022131911506897946*e20 - 2.1845675724304455e-6*e21 - 4.963727093415996e-9*e22)/
   (-4.616396862584361e-13 - 3.6987626554837435e-10*e + 2.2199967297197156e-7*e2 + 0.00004628916421708627*e3 -
     0.002304008118798134*e4 + 0.06298983609139512*e5 - 0.6406277787382678*e6 - 3.5167650188178268*e7 +
     192.24184427400343*e8 - 2117.4295381872043*e9 + 11548.342629589715*e10 - 13151.384905721165*e11 +
     11212.491449000934*e12 - 4742.373401294556*e13 + 3067.8255158942507*e14 - 1331.2232187171192*e15 +
     433.2239004538602*e16 - 32.73752014120429*e17 + 8.258268788269858*e18 + 0.5504745185457142*e19 +
     0.006760130196823705*e20 - 7.032724563397889e-6*e21 - 1.513558086157459e-8*e22);

			// return (-0.00007104993351009216 - 0.04334109642994383*e + 1.2279177679950415*e2 - 19.313370370443423*e3 + 165.38214125790088*e4 -
   //   1011.3980952872718*e5 + 57.225062401104516*e6 - 5049.784322779716*e7 + 15446.995500852634*e8 - 14488.328666550251*e9 +
   //   7236.468875558742*e10 - 1637.5485860444878*e11 + 214.9544153823399*e12 + 8.867573971529298*e13 + 0.011873815804500858*e14)/
   // (-0.0003620626638033665 - 0.1652005607001988*e + 3.824972927613314*e2 - 43.98891485569906*e3 + 169.17003028886876*e4 -
   //   277.8130623486553*e5 - 19576.526836086457*e6 + 7950.647969952832*e7 + 40916.61560479387*e8 - 42339.26231639718*e9 +
   //   24512.566534017325*e10 - 5810.863999256694*e11 + 971.9898537348656*e12 + 27.869159944760614*e13 + 0.03623121077195377*e14);

	   	// Speed of sound squared of Wuppertal-Budapest collaboration
		#else
	   		double e2 = e * e;
			double e3 = e2 * e;
			double e4 = e3 * e;
			double e5 = e4 * e;
			double e6 = e5 * e;
			double e7 = e6 * e;
			double e8 = e7 * e;
			double e9 = e8 * e;
			double e10 = e9 * e;
			double e11 = e10 * e;
			double e12 = e11 * e;
			double e13 = e12 * e;
			double e14 = e13 * e;
			double e15 = e14 * e;
		    double e16 = e15 * e;
		    double e17 = e16 * e;
		    double e18 = e17 * e;
		    double e19 = e18 * e;
		    double e20 = e19 * e;
		    double e21 = e20 * e;
		    double e22 = e21 * e;

			return (-2.178802623232077e-8 - 0.000028058668053969316*e + 0.0707167841389791*e2 + 30.072115831801668*e3 +
     2235.4049904745293*e4 + 41418.70672195756*e5 + 358508.8110784304*e6 + 1.1590875075390663e6*e7 +
     954248.3211844995*e8 - 50721.294467359*e9 + 16465.82334234105*e10 - 908.4548567500927*e11 -
     252.7359144972058*e12 + 53.91419969140143*e13 - 12.026262562371759*e14 + 1.6556097635897582*e15 -
     0.11488691302515308*e16 + 0.003829345418196134*e17 - 0.000041174256263276295*e18 -
     6.534667798749817e-7*e19 + 1.251380387174281e-8*e20 + 4.584558932434191e-11*e21 +
     1.7120085646159452e-14*e22)/
   (-1.2153701643802135e-7 - 0.00008294478323975135*e + 0.3175076406677123*e2 + 120.51666836485872*e3 +
     8774.085137082211*e4 + 182446.2005223917*e5 + 1.995089196043474e6*e6 + 9.161741300187482e6*e7 +
     8.731822712749625e6*e8 - 2.156494891121747e6*e9 + 482885.5410394763*e10 - 69411.77018853552*e11 +
     6760.932013473378*e12 - 510.63270233261545*e13 + 8.175727094657239*e14 + 3.248437668454592*e15 -
     0.32487966107613314*e16 + 0.012482882608729243*e17 - 0.00015856500475657135*e18 -
     1.7681600567702772e-6*e19 + 4.075596322495956e-8*e20 + 1.4197025154850574e-10*e21 +
     5.1982187467659597e-14*e22);

		// 	return (5.191934309650155e-32 + 4.123605749683891e-23 * e
		// 			+ 3.1955868410879504e-16 * e2 + 1.4170364808063119e-10 * e3
		// 			+ 6.087136671592452e-6 * e4 + 0.02969737949090831 * e5
		// 			+ 15.382615282179595 * e6 + 460.6487249985994 * e7
		// 			+ 1612.4245252438795 * e8 + 275.0492627924299 * e9
		// 			+ 58.60283714484669 * e10 + 6.504847576502024 * e11
		// 			+ 0.03009027913262399 * e12 + 8.189430244031285e-6 * e13)
		// 			/ (1.4637868900982493e-30 + 6.716598285341542e-22 * e
		// 					+ 3.5477700458515908e-15 * e2 + 1.1225580509306008e-9 * e3
		// 					+ 0.00003551782901018317 * e4 + 0.13653226327408863 * e5
		// 					+ 60.85769171450653 * e6 + 1800.5461219450308 * e7
		// 					+ 15190.225535036281 * e8 + 590.2572000057821 * e9
		// 					+ 293.99144775704605 * e10 + 21.461303090563028 * e11
		// 					+ 0.09301685073435291 * e12 + 0.000024810902623582917 * e13);
		#endif

	#else
		return 1.0 / 3.0;
	#endif
}


double effectiveTemperature(double e)
{
	#ifndef CONFORMAL_EOS

		// Effective temperature of BEST collaboration
		#ifdef BEST
			double e2 = e * e;
			double e3 = e2 * e;
			double e4 = e3 * e;
			double e5 = e4 * e;
			double e6 = e5 * e;
			double e7 = e6 * e;
			double e8 = e7 * e;
			double e9 = e8 * e;
			double e10 = e9 * e;
			double e11 = e10 * e;
			double e12 = e11 * e;
			double e13 = e12 * e;
			double e14 = e13 * e;
			double e15 = e14*e;
		    double e16 = e15*e;
		    double e17 = e16*e;
		    double e18 = e17*e;
		    double e19 = e18*e;
		    double e20 = e19*e;

		    // super accurate

		   	return (6.354702650133721e-7 + 0.0016261450306068567*e + 0.45825931456340785*e2 + 14.188693412528751*e3 -
     314.7885041652167*e4 + 2378.640132157695*e5 + 25273.133749493598*e6 - 140224.9709264792*e7 +
     106293.04579291707*e8 + 89517.1975351415*e9 - 70843.79668025293*e10 + 28526.039709340683*e11 -
     36943.18834114948*e12 + 189251.03702063803*e13 - 51967.87699872343*e14 + 7691.785198380105*e15 +
     9513.282503693723*e16 + 482.55672261331955*e17 + 5.389198283394992*e18 + 0.013817918026243032*e19 +
     5.570450207372526e-6*e20)/
   (4.1560932681286e-6 + 0.006747031242574442*e + 1.285101644232421*e2 + 19.36905363832382*e3 - 639.5077730169339*e4 +
     7119.547834859753*e5 + 22354.06915581833*e6 - 197845.8735584382*e7 + 189101.14796407992*e8 +
     117736.90044970746*e9 - 193723.6698826523*e10 + 186595.1710000764*e11 - 158312.42292489434*e12 +
     320049.3255747058*e13 - 111686.06861346996*e14 + 25750.640860019877*e15 + 9437.496426864122*e16 +
     334.06415213565924*e17 + 2.6440125443979445*e18 + 0.004563233640606438*e19 + 9.788656932810127e-7*e20);

			// return (-0.00004772175714325045 - 0.06554199560423501*e - 7.72468891836882*e2 + 40.76351012494611*e3 + 1723.3946721976308*e4 - 30987.07662386632*e5 +
   //   56705.06211828653*e6 + 212656.61905671275*e7 - 330412.6001812649*e8 + 169177.85971399187*e9 - 29656.052294953955*e10 -
   //   11023.320928362635*e11 - 294.3426717814427*e12 - 1.3705382972958953*e13 - 0.0008524342816199403*e14)/
   // (-0.0002860337613852848 - 0.23616976157186095*e - 16.75272112458857*e2 + 210.63792916242122*e3 + 1335.5677349417047*e4 -
   //   50810.0807002418*e5 + 139833.28919191557*e6 + 192522.59283637305*e7 - 403984.7286063468*e8 + 239768.7820635771*e9 -
   //   57299.93639300064*e10 - 9689.668223592613*e11 - 170.277961495253*e12 - 0.5100754382614187*e13 - 0.00016373849683369522*e14);

	   	// Effective temperature of Wuppertal-Budapest collaboration
	    #else
	   		double e2 = e * e;
			double e3 = e2 * e;
			double e4 = e3 * e;
			double e5 = e4 * e;
			double e6 = e5 * e;
			double e7 = e6 * e;
			double e8 = e7 * e;
			double e9 = e8 * e;
			double e10 = e9 * e;
			double e11 = e10 * e;
			double e12 = e11 * e;
			double e13 = e12 * e;
			double e14 = e13 * e;
			double e15 = e14 * e;
			double e16 = e15 * e;
			double e17 = e16 * e;
		    double e18 = e17 * e;
		    double e19 = e18 * e;
		    double e20 = e19 * e;
		    double e21 = e20 * e;
		    double e22 = e21 * e;

			return (2.805869997121848e-7 + 0.0016687441079320283*e + 1.4839310262134133*e2 + 328.65797655737566*e3 +
     20588.110903563724*e4 + 333446.5800069805*e5 + 697363.6527955428*e6 - 1.726106947423048e6*e7 -
     1.4534822597460109e6*e8 + 1.6041416532072239e6*e9 + 647591.4839233705*e10 + 196069.7894032533*e11 -
     16477.03273134262*e12 + 2239.163501912496*e13 - 139.4471798412599*e14 - 56.177945728815814*e15 +
     6.286896403438542*e16 - 0.12504404549704667*e17 - 0.005436655511967141*e18 + 0.00012779108537184535*e19 +
     1.6538755980411776e-6*e20 + 3.4758922647083855e-9*e21 + 1.1123123823913987e-12*e22)/
   (2.068456663176566e-6 + 0.008270169005048402*e + 5.525127318169887*e2 + 946.7751657179253*e3 +
     45753.72453554468*e4 + 551625.3416059491*e5 + 797512.3880244014*e6 - 2.73675388935463e6*e7 -
     1.4424551842244035e6*e8 + 2.257817112071547e6*e9 + 747469.0482756988*e10 + 222730.76660418292*e11 -
     30716.511863420095*e12 + 4901.037822665323*e13 - 575.9147472089788*e14 - 14.771489098529415*e15 +
     4.999666623329036*e16 - 0.17506789169898215*e17 - 0.0018686576242234758*e18 + 0.00009965134321146708*e19 +
     7.777887562653655e-7*e20 + 1.0812709087693346e-9*e21 + 1.8461582296389239e-13*e22);



			// return (2.059151308901543e-66 + 1.2883117551723254e-37*e + 9.653685304732326e-18*e2 + 0.0021387548523685764*e3 +
	  //    3.152348276671561e7*e4 + 6.128861811040275e14*e5 + 1.2611913502159628e20*e6 +
	  //    8.510311640702168e23*e7 + 3.3406440917885196e26*e8 + 9.526824863039937e27*e9 -
	  //    5.540454604707275e27*e10 - 3.834326779020863e28*e11 + 2.732286036998176e28*e12 +
	  //    3.389763887380034e27*e13 + 3.271304177799644e25*e14 + 3.5796316255209677e22*e15 +
	  //    3.647754101481452e18*e16)/
	  //  (3.465150960288193e-64 + 7.292333136125966e-36*e + 3.167120708990754e-16*e2 + 0.047875501682141906*e3 +
	  //    5.1924910033740276e8*e4 + 7.186120863411006e15*e5 + 9.741960860767537e20*e6 +
	  //    3.9749426686364564e24*e7 + 9.163047659503782e26*e8 + 1.4902973847933083e28*e9 -
	  //    1.710867316101183e28*e10 - 4.366544624555957e28*e11 + 3.801696016710178e28*e12 +
	  //    2.43514662137169e27*e13 + 1.376570820431094e25*e14 + 8.761759990161081e21*e15 +
	  //    4.265493796252328e17*e16);
	   	#endif

	#else
		return powf(e/EOS_FACTOR,0.25);
	#endif
}



double equilibriumEnergyDensity(double T)
{
	#ifndef CONFORMAL_EOS

		#ifdef BEST
			// energy density from BEST collaboration
			double T2 = T * T;
			double T3 = T2 * T;
			double T4 = T3 * T;
			double T5 = T4 * T;
			double T6 = T5 * T;
			double T7 = T6 * T;
			double T8 = T7 * T;
			double T9 = T8 * T;
			double T10 = T9 * T;
			double T11 = T10 * T;
			double T12 = T11 * T;
			double T13 = T12 * T;
			double T14 = T13 * T;
			double T15 = T14 * T;
			double T16 = T15 * T;
			double T17 = T16 * T;
			double T18 = T17 * T;
			double T19 = T18 * T;
			double T20 = T19 * T;

			return (-0.002999930312462119 + 0.09417646213801027*T - 1.3472144415370244*T2 + 11.531744338662536*T3 - 65.17050664643754*T4 +
		     252.96623410554895*T5 - 673.9895236411604*T6 + 1155.6029102124326*T7 - 910.3488025995453*T8 -
		     971.3230107937379*T9 + 3724.9276204901016*T10 - 4118.540210991578*T11 - 78.52429756414836*T12 +
		     5293.81004825622*T13 - 4557.553823074766*T14 - 3240.888013850884*T15 + 10697.194999962052*T16 -
		     11211.426603636184*T17 + 6481.455655216752*T18 - 2082.163818010678*T19 + 293.70151601812523*T20)/
		   (0.607428913591128 - 9.953288454061427*T + 73.64572871160192*T2 - 322.3694142746391*T3 + 912.7288538270155*T4 -
		     1687.858513517085*T5 + 1840.856145562391*T6 - 470.3775809532542*T7 - 1924.6292185965883*T8 +
		     3047.9613287381467*T9 - 1074.1083334677714*T10 - 2852.0884246377973*T11 + 5597.783660696195*T12 -
		     5456.527953543836*T13 + 3464.3092713525684*T14 - 1521.9174635327095*T15 + 471.31297621425625*T16 -
		     104.13673393295115*T17 + 16.227425444403956*T18 - 1.5313653054600316*T19 + 0.0661997114240791*T20);

   		#else
			// Effective energy density from the Wuppertal-Budapest collaboration
			double T1 = (double)T;
			double T2 = T1 * T1;
			double T3 = T2 * T1;
			double T4 = T3 * T1;
			double T5 = T4 * T1;
			double T6 = T5 * T1;
			double T7 = T6 * T1;
			double T8 = T7 * T1;
			double T9 = T8 * T1;
			double T10 = T9 * T1;
			double T11 = T10 * T1;
			double T12 = T11 * T1;
			double T13 = T12 * T1;
			double T14 = T13 * T1;
			double T15 = T14 * T1;
			double T16 = T15 * T1;
			double T17 = T16 * T1;
			double T18 = T17 * T1;
			double T19 = T18 * T1;
			double T20 = T19 * T1;
			double T21 = T20 * T1;
			double T22 = T21 * T1;
			double T23 = T22 * T1;

			return (-0.6746595680417311 + 15.18004717055557*T - 150.28838666045098*T2 + 856.8728238453558*T3 - 3067.006874419056*T4 +
     6887.691793468362*T5 - 8689.01204393483*T6 + 2779.5133034548844*T7 + 7527.143247800599*T8 -
     7280.007098663352*T9 - 5948.659144649617*T10 + 9517.34072428892*T11 + 5432.293784982603*T12 -
     11518.267479577982*T13 - 3662.4391070118304*T14 + 11510.3287888067*T15 + 2190.1375458702637*T16 -
     14631.511315975464*T17 + 11753.561347532514*T18 - 4063.357489150804*T19 + 541.1883866332131*T20)/
   (-25.236559574714622 + 171.3985969608387*T - 470.68935437785206*T2 + 609.039379929916*T3 - 254.62577340009915*T4 -
     161.54720638956582*T5 + 41.634863182950326*T6 + 95.77801093178024*T7 + 271.26565801570024*T8 -
     228.11450258806724*T9 - 549.2377700940492*T10 + 558.3772963304361*T11 + 620.0220147386352*T12 -
     1369.1552177484705*T13 + 960.5451160750602*T14 - 299.88416268160154*T15 + 24.60448576154993*T16 +
     7.327185654554338*T17 - 1.6962229435786575*T18 + 0.20830329719464258*T19 - 0.01095197778233111*T20);

			// old EOS
			// return (-0.011958188410851651 + 119.89423098138208 * T1
			// 		- 3156.9475699248055 * T2 + 32732.86844374939 * T3
			// 		- 187899.8994764422 * T4 + 712537.3610845465 * T5
			// 		- 1.557049803609345e6 * T6 + 1.4852519861308339e6 * T7
			// 		+ 532132.6079941876 * T8 - 1.963099445042592e6 * T9
			// 		- 4484.44579242679 * T10 + 1.7984228830058286e6 * T11
			// 		+ 119345.25619517374 * T12 - 1.3499773937058165e6 * T13
			// 		- 207838.4995663606 * T14 + 654970.2138652403 * T15
			// 		- 78643.00334616247 * T16 + 40274.00078068926 * T17
			// 		+ 422619.58977657766 * T18 - 409688.07836393174 * T19
			// 		- 62005.75915066359 * T20 + 46788.14270090656 * T21
			// 		+ 40784.330477857235 * T22 - 12589.47744840392 * T23)
			// 		/ (31630.074365558292 - 127100.88940643385 * T1
			// 				+ 173528.1225422275 * T2 - 39403.297956865215 * T3
			// 				- 85582.57873541754 * T4 + 9320.560804233442 * T5
			// 				+ 50882.74198960172 * T6 + 20335.926473421183 * T7
			// 				- 14897.725710713818 * T8 - 23836.484117457 * T9
			// 				- 13726.013896090335 * T10 + 4517.908673107615 * T11
			// 				+ 18056.19917986404 * T12 + 14954.82860467155 * T13
			// 				+ 2569.623976952738 * T14 - 9304.046211514986 * T15
			// 				- 15606.429173842751 * T16 + 8383.710735812094 * T17
			// 				+ 1591.3177623932843 * T18 - 678.748230997762 * T19
			// 				- 33.58687934953277 * T20 + 3.2520554133126285 * T21
			// 				- 0.19647288043440464 * T22 + 0.005443394551264717 * T23);
		#endif
	#else
		return EOS_FACTOR * powf(T,4.0);
	#endif
}


double z_Quasiparticle(double T)
{
	// z = m/T (quasiparticle model)
	#ifndef CONFORMAL_EOS

		// Modeled with BEST EOS data
		#ifdef BEST
			double T2 = T * T;
			double T3 = T2 * T;
			double T4 = T3 * T;
			double T5 = T4 * T;
			double T6 = T5 * T;
			double T7 = T6 * T;
			double T8 = T7 * T;
			double T9 = T8 * T;
			double T10 = T9 * T;
			double T11 = T10 * T;
			double T12 = T11 * T;
			double T13 = T12 * T;
			double T14 = T13 * T;
			double T15 = T14 * T;
			double T16 = T15 * T;
			double T17 = T16 * T;
			double T18 = T17 * T;
			double T19 = T18 * T;
			double T20 = T19 * T;
			double T21 = T20 * T;
			double T22 = T21 * T;


			// super accurate

			return (-0.024849858891137756 + 0.47847736373416083*T - 4.61918347715829*T2 + 29.068429322455216*T3 - 124.71500934989882*T4 +
     351.97333774650616*T5 - 574.5614209565085*T6 + 242.47052067855995*T7 + 939.3631556394441*T8 -
     1497.7161122587*T9 - 869.1541853013247*T10 + 4463.510513169322*T11 - 3155.388775545533*T12 -
     3669.9148634996404*T13 + 6025.055619284398*T14 + 2530.010229436638*T15 - 12377.828009524466*T16 +
     11064.662640234146*T17 - 1367.8202341736014*T18 - 5153.441529030352*T19 + 4692.66519828337*T20 -
     1839.6486572686679*T21 + 295.61128212686765*T22)/
   (-0.0013353616408144687 + 0.01630070964709733*T - 0.0940784693091734*T2 + 0.39761014119292426*T3 -
     1.0902179925763675*T4 - 0.6350707349088213*T5 + 17.49970782818318*T6 - 54.253564043787605*T7 +
     31.303530751694325*T8 + 188.09655216728908*T9 - 410.4192207829322*T10 - 46.729398612517514*T11 +
     1123.465391973284*T12 - 861.0382656839028*T13 - 2009.5894022610644*T14 + 4034.061184550695*T15 +
     82.58158725655181*T16 - 9138.895740558035*T17 + 15147.595016391986*T18 - 13280.168404822247*T19 +
     7035.328067245568*T20 - 2154.9632787206424*T21 + 297.54649144190483*T22);


			// return (0.0026064014526402746 + 0.02802652883794058*T - 0.727938196318722*T2 + 5.607060919052082*T3 - 24.1336634842155*T4 + 67.73083023575377*T5 -
   //   132.1926507693038*T6 + 184.2919558383676*T7 - 183.61413432713218*T8 + 126.63034823029642*T9 - 54.280879600961754*T10 +
   //   8.31311485714409*T11 + 4.863936382633305*T12 - 3.0991344536093823*T13 + 0.5807210805520174*T14)/
   // (-0.0003904645220413369 + 0.018099246871784876*T - 0.22145012579978327*T2 + 1.3812042894409837*T3 - 5.307151151881782*T4 +
   //   13.566254444384585*T5 - 23.54575194505742*T6 + 26.579151174111445*T7 - 15.11638607262148*T8 - 6.152590955890048*T9 +
   //   21.89965554191702*T10 - 22.388514605461523*T11 + 12.872312174914095*T12 - 4.195721183721125*T13 + 0.6113531210531139*T14);

   		// Modeled with Wuppertal-Budapest EOS data
   		#else
   			double T2 = T * T;
			double T3 = T2 * T;
			double T4 = T3 * T;
			double T5 = T4 * T;
			double T6 = T5 * T;
			double T7 = T6 * T;
			double T8 = T7 * T;
			double T9 = T8 * T;
			double T10 = T9 * T;
			double T11 = T10 * T;
			double T12 = T11 * T;
			double T13 = T12 * T;
			double T14 = T13 * T;
			double T15 = T14 * T;
			double T16 = T15 * T;
			double T17 = T16 * T;
			double T18 = T17 * T;
			double T19 = T18 * T;
			double T20 = T19 * T;
			double T21 = T20 * T;
			double T22 = T21 * T;


			return (0.09170766362432285 + 31.477893867949994*T - 171.4720923041977*T2 + 348.0505433081136*T3 - 278.01508474473576*T4 -
     4.090099452538992*T5 + 69.51455657407085*T6 + 57.572779749854725*T7 - 14.887082827580162*T8 -
     61.65146999493058*T9 - 13.081983675373781*T10 + 38.32427558472125*T11 + 17.159335415770617*T12 -
     20.356371374162403*T13 - 14.437661706680801*T14 + 24.046217260682386*T15 + 18.24949542696214*T16 -
     33.837725550993*T17 - 25.73947128017313*T18 + 46.25407785818272*T19 - 1.3014208236011469*T20 -
     17.86161727824165*T21 + 5.995299077737301*T22)/
   (-0.2029627504235254 + 5.955678944772665*T - 26.14385042172914*T2 + 37.910032843493795*T3 + 12.89477746020681*T4 -
     99.75427327035554*T5 + 98.48666295844663*T6 + 9.217026288266831*T7 - 71.2407321036052*T8 +
     6.23448005926286*T9 + 53.36649722702714*T10 + 1.894894203426874*T11 - 41.43766327605702*T12 -
     18.439061197583815*T13 + 25.12987742471087*T14 + 29.06484792258054*T15 - 4.674554626090905*T16 -
     25.34321247283328*T17 - 11.06682311125567*T18 + 14.537948966360654*T19 + 20.210157950158084*T20 -
     22.377274103422923*T21 + 5.77910353680565*T22);



			// return (2.195527549421445e-14 + 5.014273212142939e-11*T + 6.8769768080936324e-9*T2 - 1.3090323372462384e-6*T3 + 0.00007503723419734601*T4 -
	  //    	0.0019335423100477788*T5 + 0.0077581370622797526*T6 + 1.0840238709953247*T7 - 40.41237726417249*T8 + 815.5709414412947*T9 -
	  //    	11117.3113417968*T10 + 107720.35990943392*T11 - 727161.0603316505*T12 + 3.12288627176472e6*T13 - 7.240727201149486e6*T14 +
	  //    	8.813651470346985e6*T15 - 3.535759885234317e6*T16 - 5.454281769326236e6*T17 + 1.0415987187648855e7*T18 -
	  //    	8.0189396235499745e6*T19 + 2.6430627991581215e6*T20)/
	  //  	(1.1541703277540495e-16 + 4.122377967105372e-13*T + 1.2528690762234088e-10*T2 - 1.1203883703791743e-8*T3 - 3.65428489042621e-8*T4 +
	  //    	0.00004068369176438496*T5 - 0.0024580222716044254*T6 + 0.08433957015198745*T7 - 2.0279246693088906*T8 +
	  //    	36.56366190486074*T9 - 490.05025567116945*T10 + 4477.3308927313055*T11 - 21467.525530376926*T12 - 23929.310531648207*T13 +
	  //    	889228.088912891*T14 - 4.262596231414713e6*T15 + 1.0642287968093066e7*T16 - 1.643826578603126e7*T17 +
	  //    	1.6160269998993594e7*T18 - 9.40765741315934e6*T19 + 2.502796051035953e6*T20);

	   	#endif

   	#else
   		return 0.0;
   	#endif
}

double mdmde_Quasiparticle(double e)
{
	// m * dm/de (quasiparticle model)
	#ifndef CONFORMAL_EOS

		// Modeled with BEST EOS
		#ifdef BEST
			double e2 = e * e;
			double e3 = e2 * e;
			double e4 = e3 * e;
			double e5 = e4 * e;
			double e6 = e5 * e;
			double e7 = e6 * e;
			double e8 = e7 * e;
			double e9 = e8 * e;
			double e10 = e9 * e;
			double e11 = e10 * e;
			double e12 = e11 * e;
			double e13 = e12 * e;
			double e14 = e13 * e;
			double e15 = e14 * e;
			double e16 = e15 * e;
			double e17 = e16 * e;
			double e18 = e17 * e;
			double e19 = e18 * e;
			double e20 = e19 * e;
			double e21 = e20 * e;
			double e22 = e21 * e;
			double e23 = e22 * e;
			double e24 = e23 * e;
			double e25 = e24 * e;
			double e26 = e25 * e;

			// super accurate

			return (-1.1927967184213977e-16 - 6.93974002078785e-14*e + 1.9869461829302351e-10*e2 - 8.208591908642511e-8*e3 +
     2.1583246622414057e-6*e4 + 0.00295868687991236*e5 - 0.17822845705127216*e6 + 5.475450243005113*e7 -
     112.74127105299743*e8 + 1792.0308572672911*e9 - 23579.344765116297*e10 + 255189.75987280835*e11 -
     2.150714313919863e6*e12 + 1.3217785117761483e7*e13 - 5.577544865333324e7*e14 + 1.5312086360101765e8*e15 -
     2.6254487591150045e8*e16 + 2.8330538234837854e8*e17 - 2.0088099636636007e8*e18 + 8.347774051502697e7*e19 -
     2.0059418552083727e7*e20 + 2.3761027880381965e6*e21 - 177245.14183632794*e22 + 14339.985029833542*e23 -
     425.93472333750054*e24 - 2.577223524643679*e25 - 0.0008855556603909956*e26)/
   (3.0182841741089683e-21 - 6.577567640649949e-16*e + 4.815941355358405e-13*e2 + 9.975024228049674e-11*e3 -
     1.3894925021353866e-7*e4 + 0.000022993194037377313*e5 + 0.0012773521621841865*e6 - 0.1065579618826654*e7 +
     3.590371338387996*e8 - 80.48923667947855*e9 + 1393.5544507541963*e10 - 18894.187421954797*e11 +
     192969.21573898598*e12 - 1.408144757359425e6*e13 + 6.7921946177834235e6*e14 - 1.8712911902045455e7*e15 +
     1.804160400553675e7*e16 + 2.8706083779758964e7*e17 - 6.826894176947126e7*e18 + 6.86350446212044e7*e19 -
     3.355884995662966e7*e20 + 9.82011720923614e6*e21 - 1.659176852926879e6*e22 + 322524.77250394184*e23 -
     29476.7992154663*e24 - 486.03870527880787*e25 - 0.8934224937867911*e26);



			// return (6.919441081162285e-9 - 5.57100063293304e-6*e - 0.00016522587353062757*e2 + 0.5616029745122442*e3 - 16.691592446421634*e4 +
   //   216.07087942550672*e5 + 568.4386980428922*e6 - 36211.2022726106*e7 + 364630.14434359816*e8 - 967611.6935514084*e9 +
   //   851015.4697303338*e10 - 425839.827533216*e11 + 348091.558301772*e12 - 174288.3373241143*e13 + 38832.723776720304*e14 -
   //   2020.2854944507055*e15 - 593.068081831844*e16 + 31.27368108620875*e17 + 0.01482347231998717*e18)/
   // (8.696292762109553e-12 + 6.9162142749107e-9*e - 0.000013693154154977182*e2 + 0.0029379859177626156*e3 + 0.3949453171248558*e4 -
   //   13.056530554274449*e5 + 225.48458934391144*e6 - 1617.8307625321952*e7 + 8317.495549606709*e8 - 39162.636624694795*e9 +
   //   1.0173880889931801e6*e10 - 2.0262767180622902e6*e11 + 1.5369240848851132e6*e12 - 475202.12368260603*e13 - 96932.82403205821*e14 +
   //   106036.76276940196*e15 - 27702.816228737054*e16 + 2846.9697611233128*e17 + 13.974730457893399*e18);

	   	// Modeled with Wuppertal-Budapest EOS data
	   	#else
			double e2 = e * e;
			double e3 = e2 * e;
			double e4 = e3 * e;
			double e5 = e4 * e;
			double e6 = e5 * e;
			double e7 = e6 * e;
			double e8 = e7 * e;
			double e9 = e8 * e;
			double e10 = e9 * e;
			double e11 = e10 * e;
			double e12 = e11 * e;
			double e13 = e12 * e;
			double e14 = e13 * e;
			double e15 = e14 * e;
			double e16 = e15 * e;
			double e17 = e16 * e;
			double e18 = e17 * e;
			double e19 = e18 * e;
			double e20 = e19 * e;
			double e21 = e20 * e;
			double e22 = e21 * e;
			double e23 = e22 * e;
			double e24 = e23 * e;


			return (1.95329061017391e-8 - 3.3864591099208037e-7*e - 0.010132734695886053*e2 + 1.6753243797332422*e3 +
     505.0230978675841*e4 + 11677.208913547789*e5 - 55703.604828668744*e6 + 1479.0200007231247*e7 +
     61761.447490081344*e8 + 143627.25733808105*e9 + 226690.4925520967*e10 - 293050.8720934472*e11 -
     94524.55168666519*e12 - 61017.68288638332*e13 - 229443.3864504896*e14 + 180361.8519145171*e15 +
     243634.70610154347*e16 - 159284.78192644802*e17 + 21245.39044520998*e18 - 1076.649585647334*e19 +
     81.46116084351611*e20 - 8.452263332922929*e21 + 0.2891561651312173*e22 + 0.00010477110249757475*e23 -
     5.924454664628676e-7*e24)/
   (1.263748595093237e-11 + 5.369270863996899e-8*e - 0.000031466506506184786*e2 - 0.009205496057306299*e3 +
     4.121377887104778*e4 + 433.1622186125416*e5 + 6370.443724035817*e6 + 38796.78488518795*e7 -
     100233.238972959*e8 + 69521.1493253967*e9 - 572164.8929417476*e10 + 695111.7298044853*e11 -
     607486.3603072201*e12 + 647957.760858581*e13 + 154931.63752634017*e14 - 407878.1511277599*e15 +
     318788.79614717636*e16 - 403925.1609669887*e17 + 195835.5382324677*e18 - 37733.36512024303*e19 +
     5990.489285897725*e20 - 507.5085020546778*e21 + 12.709293209963018*e22 + 0.18803526530907066*e23 -
     0.0002519337243322702*e24);

			// return (1.0932938963420931e-38 - 1.007252920091783e-31*e + 1.258073500377669e-25*e2 + 3.7902939287037426e-19*e3 +
	  //    9.982754875153906e-14*e4 + 5.356830067926448e-9*e5 + 0.00006631556444292836*e6 + 0.19429591145238154*e7 +
	  //    133.14135704995198*e8 + 19906.496386848434*e9 + 468502.08289765124*e10 - 2.1057407552865325e6*e11 -
	  //    3.1682608543291925e6*e12 + 1.7046132756833293e7*e13 - 1.3636657914477058e7*e14 + 2.0863251242849804e7*e15 -
	  //    2.0496583087455064e7*e16 - 4.069098068002096e7*e17 + 3.445677209399048e7*e18 - 3.7295352481362685e6*e19 +
	  //    212848.6045508894*e20 - 15965.651067054185*e21 + 532.5403558600549*e22 + 2.411729540242231*e23 +
	  //    0.00027216645617684197*e24)/
	  //  (1.8097473184974786e-43 - 1.1919700038034044e-36*e - 2.880545193459095e-30*e2 + 1.5774335161251585e-23*e3 +
	  //    1.2056411612584795e-17*e4 + 1.5859303052883873e-12*e5 + 4.642427449619644e-8*e6 + 0.0003211322658208788*e7 +
	  //    0.5307842016671973*e8 + 205.22641687449376*e9 + 17197.020001063076*e10 + 262076.7134892617*e11 +
	  //    1.517168279215402e6*e12 - 4.41387607180566e6*e13 - 4.689689648983293e6*e14 - 1.1727564734279385e6*e15 +
	  //    4.517859607565268e6*e16 + 1.8472203478591543e7*e17 + 1.8233835956962608e7*e18 - 2.052678068458237e7*e19 +
	  //    1.7590273805695719e6*e20 - 448178.89154244727*e21 + 13727.684912668212*e22 + 572.3076682226775*e23 +
	  //    0.5135708549693685*e24);
	   	#endif

	#else
		return 0.0;
	#endif
}


double mdmdT_Quasiparticle(double T)
{
	// m * dm/dT (quasiparticle model; nf = 3 flavors)
	#ifndef CONFORMAL_EOS

		// Modeled with BEST EOS data
		#ifdef BEST
			double T2 = T * T;
			double T3 = T2 * T;
			double T4 = T3 * T;
			double T5 = T4 * T;
			double T6 = T5 * T;
			double T7 = T6 * T;
			double T8 = T7 * T;
			double T9 = T8 * T;
			double T10 = T9 * T;
			double T11 = T10 * T;
			double T12 = T11 * T;
			double T13 = T12 * T;
			double T14 = T13 * T;
			double T15 = T14 * T;
			double T16 = T15 * T;
			double T17 = T16 * T;
			double T18 = T17 * T;
			double T19 = T18 * T;
			double T20 = T19 * T;
			double T21 = T20 * T;
			double T22 = T21 * T;
			double T23 = T22 * T;
			double T24 = T23 * T;

			// super accurate

			return (0.005608417560932825 - 0.15965291363321024*T + 2.146506769835765*T2 - 17.354276998247887*T3 + 90.32274484030113*T4 -
     303.9265552567468*T5 + 618.9905393945672*T6 - 547.5562832445656*T7 - 521.9462027835724*T8 +
     1721.3151516515818*T9 - 731.2096347868167*T10 - 1443.9401042636614*T11 - 870.4569183528523*T12 +
     6551.503232236555*T13 - 2627.2113280358517*T14 - 12604.448964689245*T15 + 14332.100188698501*T16 +
     15118.33682963929*T17 - 53173.87779136548*T18 + 64976.55134638874*T19 - 47204.94046858447*T20 +
     22377.742131747196*T21 - 6920.108193943858*T22 + 1288.320465405942*T23 - 110.20189027654786*T24)/
   (0.0009776516320639935 - 0.027168677980705117*T + 0.36163512058041053*T2 - 2.9924085159293328*T3 +
     16.698862761287625*T4 - 64.11109829416328*T5 + 165.27786952094266*T6 - 255.31075747680555*T7 +
     111.74686388172418*T8 + 408.3025042325941*T9 - 816.3191564786562*T10 + 158.2107422849028*T11 +
     1375.9994607373835*T12 - 1655.0619808217239*T13 - 646.2615866628834*T14 + 3079.1521065329284*T15 -
     2128.8975162162155*T16 - 1555.3566029797023*T17 + 3997.0020859286547*T18 - 3369.047525396329*T19 +
     1418.9666183145537*T20 - 165.7711875848563*T21 - 124.81414498920952*T22 + 61.01936402944954*T23 -
     8.765538990619126*T24);

			// return (0.0012622527708479245 - 0.08230134533246514*T + 1.4653434037820916*T2 - 13.467428027029593*T3 + 77.74832655970484*T4 -
   //   309.19153303982904*T5 + 891.2134492693693*T6 - 1917.9331962427634*T7 + 3133.595983795615*T8 - 3916.190406556193*T9 +
   //   3742.8091523429553*T10 - 2714.050189592344*T11 + 1468.0555168114784*T12 - 574.8301450676981*T13 + 154.57086488076865*T14 -
   //   25.745006329154513*T15 + 2.0303007449395563*T16)/
   // (-0.0009313000546360748 + 0.018664465770442732*T - 0.16493327030798902*T2 + 0.8334048890496392*T3 - 2.543447347766012*T4 +
   //   4.059713566147326*T5 + 1.4038507206996471*T6 - 26.207200932016356*T7 + 76.40742925039167*T8 - 135.0772046500302*T9 +
   //   166.5128297988099*T10 - 148.50313614481442*T11 + 96.0442427183015*T12 - 44.15908783422256*T13 + 13.789124161533355*T14 -
   //   2.657770912391412*T15 + 0.24445703739595379*T16);

	   	// Modeled with Wuppertal-Budapest EOS data
	   	#else
	   		double T2 = T * T;
			double T3 = T2 * T;
			double T4 = T3 * T;
			double T5 = T4 * T;
			double T6 = T5 * T;
			double T7 = T6 * T;
			double T8 = T7 * T;
			double T9 = T8 * T;
			double T10 = T9 * T;
			double T11 = T10 * T;
			double T12 = T11 * T;
			double T13 = T12 * T;
			double T14 = T13 * T;
			double T15 = T14 * T;
			double T16 = T15 * T;
			double T17 = T17 * T;
			double T18 = T18 * T;
			double T19 = T18 * T;
			double T20 = T19 * T;

			return (-3.028163612386263 + 98.73401869758305*T - 511.80174808391024*T2 + 1055.0741832198837*T3 - 846.746417261978*T4 -
     110.30561292661812*T5 + 397.43649852839525*T6 + 149.73095985304266*T7 - 190.09344913083802*T8 -
     185.27871805472296*T9 + 41.42701637225608*T10 + 199.19717383158633*T11 + 24.17109944589548*T12 -
     225.5221602242409*T13 + 41.118417163779505*T14 + 172.29042730398783*T15 - 102.18896578757689*T16 -
     76.7720473291614*T17 + 117.24436583720603*T18 - 53.45778874409243*T19 + 8.770783901630884*T20)/
   (0.8206250128057959 - 0.4164311946445899*T - 15.883545739669731*T2 + 34.49470094656446*T3 + 69.33570333148452*T4 -
     382.55981003290265*T5 + 612.1392812015968*T6 - 333.37199795398413*T7 - 221.07178216721667*T8 +
     329.2271693848648*T9 + 57.438161620880535*T10 - 238.2487820559714*T11 - 9.292954213897902*T12 +
     172.7836083273217*T13 - 31.044612393751912*T14 - 96.06511391366193*T15 + 54.81464315308174*T16 +
     4.809677278559935*T17 - 8.646938417696239*T18 + 0.1881364321986544*T19 + 0.5503683342350166*T20);

			// return (6.816033132910849e-10 + 1.7790915724868891e-6*T - 0.00030685573686689566*T2 + 0.023473842070213607*T3 - 1.0732881083537456*T4 +
	  //    	32.832198021861664*T5 - 709.7072077947313*T6 + 11127.167196570503*T7 - 127334.34497884315*T8 + 1.0505151080327253e6*T9 -
	  //    	6.040988782373799e6*T10 + 2.2838438268810038e7*T11 - 5.285418442808765e7*T12 + 7.498857047120465e7*T13 - 6.56141265603832e7*T14 +
	  //    	3.244851452301533e7*T15 - 4.306248519325042e6*T16 - 4.246216963572507e6*T17 + 1.8321297087034914e6*T18)/
	  //  	(1.6642262354933514e-10 + 2.392737679464936e-8*T - 5.770833446723635e-6*T2 + 0.00047650968449680815*T3 - 0.02381082180560632*T4 +
	  //    	0.8393191062044852*T5 - 22.059270410143014*T6 + 436.7671455149582*T7 - 6431.104009203983*T8 + 68566.51769617059*T9 -
	  //    	509112.8351052782*T10 + 2.5006513314870317e6*T11 - 7.741180724418022e6*T12 + 1.5432809530797705e7*T13 - 2.021565552418443e7*T14 +
	  //    	1.7198582484739084e7*T15 - 8.803186353145795e6*T16 + 2.1173893883225573e6*T17 - 25629.370279979517*T18);

	   	#endif

	#else
		return 0.0;
	#endif
}


// parameterization for specific bulk viscosity
double bulkViscosityToEntropyDensity(double T)
{
	#ifndef CONFORMAL_EOS
		double a0 = -13.45;
		double a1 = 27.55;
		double a2 = -13.77;

		double lambda1 = 0.9;
		double lambda2 = 0.25;
		double lambda3 = 0.9;
		double lambda4 = 0.22;

		double sigma1 = 0.025;
		double sigma2 = 0.13;
		double sigma3 = 0.0025;
		double sigma4 = 0.022;

		double Tpeak = T_PEAK;

		//cout << Tpeak << endl;

		double x = T/T_PEAK;

		//double result = a0 + a1*x + a2*x*x;

		double result;

		if(x > 1.05)
			result = lambda1*exp(-(x-1.0)/sigma1) + lambda2*exp(-(x-1.0)/sigma2) + 0.001;
		else if(x < 0.995)
			result = lambda3*exp((x-1.0)/sigma3)+ lambda4*exp((x-1.0)/sigma4) + 0.03;
		else
			result = a0 + a1*x + a2*x*x;

		#ifndef CONSTANT_VISCOSITY
			double zeta_norm = ZETA_NORM;
			return zeta_norm * result;
		#else
			return result;
		#endif
	#else
		return 0.0;
	#endif
}

// parameterization for temperature dependent shear viscosity
double shearViscosityToEntropyDensity(double T)
{
	#ifndef CONSTANT_VISCOSITY
		double etas_min = ETAS_MIN;
		double etas_slope = ETAS_SLOPE;

		double Tc = 0.154 * 5.067731;

		double ans;

		if(T > Tc)
			ans = etas_min + etas_slope*(T-Tc);
		else if(T <= Tc)
			ans = etas_min;

		return ans;
	#else
		return CONSTANT_ETAS;
	#endif
}






double equilibriumBquasi(double T)
{
	// equilibrium mean field
	#ifndef CONFORMAL_EOS

		// modeled with BEST EOS data
		#ifdef BEST
			double T2 = T * T;
			double T3 = T2 * T;
			double T4 = T3 * T;
			double T5 = T4 * T;
			double T6 = T5 * T;
			double T7 = T6 * T;
			double T8 = T7 * T;
			double T9 = T8 * T;
			double T10 = T9 * T;
			double T11 = T10 * T;
			double T12 = T11 * T;
			double T13 = T12 * T;
			double T14 = T13 * T;
			double T15 = T14 * T;
			double T16 = T15 * T;
			double T17 = T16 * T;
			double T18 = T17 * T;
			double T19 = T18 * T;
			double T20 = T19 * T;

			// super accurate

			return (0.050807553593981314 - 1.5689532639107107*T + 22.058925282111556*T2 - 186.46436942623802*T3 + 1054.8363701384187*T4 -
     4208.039545493059*T5 + 12118.826371672492*T6 - 25136.8737959246*T7 + 35854.55231319769*T8 -
     28711.571443848883*T9 - 6069.162219288527*T10 + 53559.81412173025*T11 - 78331.6574712575*T12 +
     58756.1396988773*T13 - 12443.794232270604*T14 - 23027.5229322638*T15 + 29559.10660409062*T16 -
     18193.57166869241*T17 + 6630.21829352344*T18 - 1368.9464729972105*T19 + 123.57849591412831*T20)/
   (54.333991663395125 - 892.1598816769438*T + 6678.706492335427*T2 - 30133.53859399463*T3 + 91127.7739984867*T4 -
     193659.35059973205*T5 + 292541.0089980787*T6 - 303878.2121603155*T7 + 183600.71746461073*T8 +
     7590.438830781842*T9 - 150077.88979897177*T10 + 178076.66061809257*T11 - 123525.97200512807*T12 +
     56749.22929795278*T13 - 16975.405747105848*T14 + 2887.6602368384947*T15 - 135.07044953188364*T16 -
     33.34448249826969*T17 + 4.918440361610946*T18 - 0.4806683822803251*T19 + 0.02067796139693879*T20);


			// return (-0.6888093188133221 + 13.830135911946835*T - 119.47726516302767*T2 + 580.3976845710779*T3 - 1740.5950182569736*T4 + 3342.631345544237*T5 -
   //   4156.859906472405*T6 + 3381.904455467014*T7 - 2035.918921343998*T8 + 1433.9628989991259*T9 - 1244.419414812131*T10 +
   //   711.6839024142074*T11 - 165.5705388313795*T12)/
   // (14.307224529850942 - 431.289946841596*T + 3245.0973907798125*T2 - 10796.084272157786*T3 + 18963.774825293316*T4 - 17842.997826536815*T5 +
   //   6599.969484504847*T6 + 3544.9656011651978*T7 - 5615.141001183261*T8 + 3083.0483419246552*T9 - 892.7941312679603*T10 +
   //   141.04662199822738*T11 - 9.482641602947682*T12);

	   #else
	   		double T2 = T * T;
			double T3 = T2 * T;
			double T4 = T3 * T;
			double T5 = T4 * T;
			double T6 = T5 * T;
			double T7 = T6 * T;
			double T8 = T7 * T;
			double T9 = T8 * T;
			double T10 = T9 * T;
			double T11 = T10 * T;
			double T12 = T11 * T;
			double T13 = T12 * T;
			double T14 = T13 * T;
			double T15 = T14 * T;
			double T16 = T15 * T;
			double T17 = T16 * T;
			double T18 = T17 * T;
			double T19 = T18 * T;
			double T20 = T19 * T;

			return (19.40792947323188 - 342.0263387469813*T + 2578.242086743804*T2 - 10619.929493490272*T3 + 24985.83034443322*T4 -
     32422.095136126005*T5 + 20631.134901306315*T6 - 9226.280024763879*T7 + 14807.369870741783*T8 -
     2888.3379582824937*T9 - 29195.318316647674*T10 + 14671.8936104707*T11 + 33946.737465802296*T12 -
     31656.730028637397*T13 - 4964.959699285339*T14 + 10877.8429393955*T15 + 1436.4665900587586*T16 -
     2649.0569522213736*T17 - 610.3672174408359*T18 + 755.1701409806524*T19 - 133.9584939041013*T20)/
   (19142.656974668585 - 154846.05101852873*T + 539267.185191327*T2 - 1.0215562949639153e6*T3 +
     1.0541671057321753e6*T4 - 393173.65077612136*T5 - 344907.32542035833*T6 + 486863.54785741604*T7 -
     194270.00402842*T8 - 28603.417269431873*T9 + 56129.67324026361*T10 - 16375.781761169725*T11 -
     7598.880720560649*T12 + 7007.200455460863*T13 + 330.54710937412455*T14 - 3505.431547985612*T15 +
     3130.5297967162674*T16 - 1600.0066738078033*T17 + 469.7385200718001*T18 - 72.04743960804596*T19 +
     4.597612981223469*T20);


			// return (-0.003259287424704517 + 0.4709321130178677*T - 18.471027719937705*T2 + 334.0690722721871*T3 - 3454.385244668648*T4 +
	  //    22960.15979638924*T5 - 105315.46668675772*T6 + 346561.90522823617*T7 - 836638.407629094*T8 +
	  //    1.501743414016609e6*T9 - 2.020237220416e6*T10 + 2.0480693209160143e6*T11 - 1.5779382837830463e6*T12 +
	  //    943559.9448756306*T13 - 456516.3985230772*T14 + 185756.11302939596*T15 - 61106.69072505601*T16 +
	  //    13705.921942194844*T17 - 1465.8180676090112*T18)/
	  //  (294.675932969415 - 1745.8088045773043*T + 3997.025794070807*T2 - 3586.7652790072334*T3 - 1117.8588245192668*T4 +
	  //    3765.9359654630407*T5 + 841.4750390325167*T6 - 4142.400568278239*T7 - 1464.515167915579*T8 +
	  //    4738.833500521431*T9 + 2188.180519746309*T10 - 6031.500378704362*T11 - 203.76274436224986*T12 +
	  //    5225.119313817963*T13 - 3608.5761295285674*T14 + 927.278254033823*T15 - 80.77885500958108*T16 +
	  //    4.197658993150538*T17 - 0.10024694968615945*T18);
	   	#endif

   #else
   		return 0.0;
	#endif
}

















